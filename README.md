# Pentesting-tools
This repo contains tips and tool i use in penetration testing

# CYBERSECURITY ASSESSMENT.

###### It envolves evaluation of the following componets.

- Current assets (includes application, network, systems, data, etc.)
- Business compliance with the relevant security ordinance
- Vulnerabilities present in the assets
- Identify the attack surface.
- Potential threats and risks on assets
- Assets’ cyber resiliency
- Assets prevention cost with proportion to assets cost

###### Pentesting types.

- Web-application Penetration Testing
- Mobile Application Penetration Testing
- Network Penetration Testing (It can be performed separately on the external network and internal network)
- Cloud security penetration testing
- Embedded devices penetration testing
- IoT/IIoT Penetration Testing
- Thick client Penetration Testing
- Thin client Penetration Testing
- Virtual Appliances Penetration Testing

# WEB APPLICATION:

## Structure of web application

* skipfish
```bash
 skipfish -o ouputDir https://example.com
 ```
* wapiti
```bash
wapiti -u http://target/
```
* arjun HTTP Parameter Discovery Suite
```bash
arjun -u https://example.com
```
* Osmedus offensive framework tools
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/osmedeus/osmedeus-base/master/install.sh)
```
- usage
```bash
sudo osmedeus scan -f vuln -t example.com
```
* Ammass Enumeration.
```bash
amass enum -active -d example.com | grep api
```

### BUGS

* Black list and white lists validations

```bash
A vulnerability when developer use black list instead of white lists in validation
```

## WEB APPLICATION SECURITY CHECKLIST.


- [x] Sql Injection Attack

- [x] Hibernate Query Language Injection

- [x] Direct OS Code Injection

- [x] XML Entity Injection

- [x] Broken Authentication and Session Management
```bash
1. Cookie does not expire.
2. Password reset link does not expire.
3. Session Fixation.. Not changing session data.
4. Credential Stuffing
5. Application session timeouts aren't set properly
```
- [https://hackerone.com/reports/23579](https://hackerone.com/reports/23579)
- [https://hackerone.com/reports/18503](https://hackerone.com/reports/18503)
- [https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPOAUTH.md](https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPOAUTH.md)
- [https://auth0.com/blog/what-is-broken-authentication/](https://auth0.com/blog/what-is-broken-authentication/).
- [https://aswingovind.medium.com/how-to-hunt-for-a01-2021-broken-access-control-fc6bc0eadf7e](https://aswingovind.medium.com/how-to-hunt-for-a01-2021-broken-access-control-fc6bc0eadf7e)

- [x] Cross-Site Scripting (XSS)

- [x] Insecure Direct Object References

- [https://hackerone.com/reports/265284](https://hackerone.com/reports/265284)
- [https://hackerone.com/reports/52646](https://hackerone.com/reports/52646)

 
- [x] Security Misconfiguration

- [https://hackerone.com/reports/796557](https://hackerone.com/reports/796557)
- [https://hackerone.com/reports/230648](https://hackerone.com/reports/230648)
- [https://hackerone.com/reports/470298](https://hackerone.com/reports/470298)
- [https://hackerone.com/reports/426147](https://hackerone.com/reports/426147)
- [https://hackerone.com/reports/758785](https://hackerone.com/reports/758785)
- 
- 
- [x] Sensitive Data Exposure

- [https://hackerone.com/reports/340431](https://hackerone.com/reports/340431)

- [x] Missing Function Level Access Control

- [x] Cross-Site Request Forgery (CSRF)

- [https://hackerone.com/reports/157993](https://hackerone.com/reports/157993)
- [https://hackerone.com/reports/419891](https://hackerone.com/reports/419891)

- [x] Using Components with Known Vulnerabilities

- [x] Unvalidated Redirects and Forw 173

- [x] Execution After Redirect (EAR)ards
```bash
<?php
/* Redirect browser */
header("Location: http://www.mysite.com");
/* Exit to prevent the rest of the code from executing */
exit; // without exit() it wil cause Execution After Redirect vulnerability.
?>
```

- [x] Click Jacking Attacks
```bash
'preventing'
1. Ensure proper Content Security Policy (CSP).
2. SameSite=Strict (or Lax)
3. X-Frame-Options Response Headers. can be `(DENY,SAMEORIGIN,ALLOW-FROM URI)`
```
- [x] DNS Cache Poisoning

- [x] Symlinking – An Insider Attack:
```bash
<?php
$target = 'uploads.php';
$link = 'uploads';
symlink($target, $link);

echo readlink($link);
?>
'See Also'
link() - Create a hard link
readlink() - Returns the target of a symbolic link
linkinfo() - Gets information about a link
unlink() - Deletes a file
```

- [x] Remote Code Execution Attacks
- [https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPRCE.md](https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPRCE.md).

- [x] Remote File inclusion

- [x] Local file inclusion

- [x] EverCookie
```bash
reproduces intentionally deleted cookies on the clients' browser storage
```
- [x] Denial oF Service Attack

- [x] Cookie Eviction

- [x] PHPwn

- [x] NAT Pinning

- [x] XSHM

- [x] MitM DNS Rebinding SSL/TLS Wildcards and

- [x] Quick Proxy Detection

- [x] Improving HTTPS Side Channel Attacks

- [x] Side Channel Attacks in SSL

- [x] Turning XSS into Clickjacking

- [x] Bypassing CSRF protections with ClickJacking

- [x] HTTP Parameter Pollution

```bash
GET /api_v1/messages?user_id=VICTIM_ID → 401 Unauthorized

GET /api_v1/messages?user_id=ATTACKER_ID&user_id=VICTIM_ID → 200 OK

GET /api_v1/messages?user_id=YOUR_USER_ID[]&user_id=ANOTHER_USERS_ID[]
```

- [x] URL Hijacking

- [x] Stroke Jacking

- [x] Fooling B64_Encode(Payload) on WAFs And Filters

- [x] MySQL Stacked Queries with SQL Injection.

- [x] Posting Raw XML cross-domain

- [x] Generic Cross-Browser Cross-Domain theft

- [x] Attacking HTTPS with Cache Injection

- [x] Tap Jacking

- [x] XSS - Track

- [x] Next Generation Click Jacking

- [x] XSSing Client-Side Dynamic HTML.

- [x] Stroke triggered XSS and Stroke Jacking

- [x] Lost iN Translation

- [x] Persistent Cross Interface Attacks

- [x] Chronofeit Phishing

- [x] SQLi Filter Evasion Cheat Sheet (MySQL)

- [x] Tabnabbing

- [x] UI Redressing

- [x] Cookie Poisoning

- [x] SSRF

- [x] Bruteforce of PHPSESSID

- [x] Blended Threats and JavaScript

- [x] Cross-Site Port Attacks

- [x] CAPTCHA Re-Riding Attack



### Web Application Attacks List ?

- [x] Arbitrary file access

- [x] Binary planting

- [x] Blind SQL Injection

- [x] Blind XPath Injection

- [x] Brute force attack

- [x] Buffer overflow attack

- [x] Cache Poisoning

- [x] Cash Overflow

- [x] Clickjacking

- [x] Command injection attacks

- [x] Comment Injection Attack

- [x] Content Security Policy

- [x] Content Spoofing

- [x] Credential stuffing

- [x] Cross Frame Scripting

- [x] Cross Site History Manipulation (XSHM)

- [x] Cross Site Tracing

- [x] Cross-Site Request Forgery (CSRF)

- [x] Cross Site Port Attack (XSPA)

- [x] Cross-Site Scripting (XSS)

- [x] Cross-User Defacement

- [x] Custom Special Character Injection

- [x] Denial of Service

- [x] Direct Dynamic Code Evaluation (‘Eval Injection’)

- [x] Exploitation of CORS

- [x] Forced browsing

- [x] Form action hijacking

- [x] Format string attack

- [x] Full Path Disclosure

- [x] Function Injection

- [x] Host Header injection

- [x] HTTP Response Splitting

- [x] HTTP verb tampering

- [x] HTML injection

- [x] LDAP injection

- [x] Log Injection

- [x] Man-in-the-browser attack

- [x] Man-in-the-middle attack

- [x] Mobile code: invoking untrusted mobile code

- [x] Mobile code: non-final public field

- [x] Mobile code: object hijack

- [x] One-Click Attack

- [x] Parameter Delimiter

- [x] Page takeover

- [x] Path Traversal

- [x] Reflected DOM Injection

- [x] Regular expression Denial of Service – ReDoS

- [x] Repudiation Attack

- [x] Resource Injection

- [x] Server-Side Includes (SSI) Injection

- [x] Session fixation

- [x] Session hijacking attack

- [x] Session Prediction

- [x] Setting Manipulation

- [x] Special Element Injection

- [x] SMTP injection

- [x] SQL Injection

- [x] SSI injection

- [x] Traffic flood

- [x] Web Parameter Tampering

- [x] XPATH Injection

- [x] XSRF or SSRF

- [x] JavaScript Prototype Pollution

- [x] Insecure object deserialisation

##  OWASP API Top 10 Security Threats `checklist`

- [x] API1:2019: Broken Object-Level Authorization

- [x] Broken User Authentication

- [x] Excessive Data Exposure

- [x] Lack of Resources and Rate Limiting

- [x] Broken Function Level Authorization

- [x] Mass Assignment:
```bash
Examples for sensitive properties:
• Permission-related properties: user.is_admin, user.is_vip should only be set by admins.
• Process-dependent properties: user.cash should only be set internally after payment verification.
• Internal properties: article.created_time should only be set internally by the application
```

- [x] Security Misconfiguration

- [x] Injection

- [x] Improper Assets Management

- [x] Insufficient Logging and Monitoring.

## Resources:

- [https://owasp.org/www-project-desktop-app-security-top-10/](https://owasp.org/www-project-desktop-app-security-top-10/)

- [https://brightsec.com/blog/api-security/](https://brightsec.com/blog/api-security/)

- [https://owasp.org/www-project-api-security/](https://owasp.org/www-project-api-security/)
 
- [https://sushant747.gitbooks.io/total-oscp-guide/content/bash-scripting.html](https://sushant747.gitbooks.io/total-oscp-guide/content/bash-scripting.html)


## ANDROID  APPLICATION SECURITY CHECKLIST.

- [x] Exposure of Sensitive Information to an Unauthorized Actor                   
- [x] Execution with Unnecessary Privileges                       
- [x] Improper Certificate Validation                        
- [x] Improper Validation of Certificate with Host Mismatch                    
- [x] Cleartext Storage of Sensitive Information                      
- [x] Cleartext Transmission of Sensitive Information                      
- [x] Exposure of Private Personal Information to an Unauthorized Actor                  
- [x] Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')                 
- [x] Logic/Time Bomb                         
- [x] Client-Side Enforcement of Server-Side Security                      
- [x] Operation on a Resource after Expiration or Release                   
- [x] Missing Release of Resource after Effective Lifetime                    
- [x] Use of Hard-coded Credentials                       
- [x] Improper Restriction of Power Consumption                      
- [x] Storage of Sensitive Data in a Mechanism without Access Control                 
- [x] Improper Verification of Intent by Broadcast Receiver                    
- [x] Improper Export of Android Application Components                     
- [x] Use of Implicit Intent for Sensitive Communication                    
- [x] Improper Authorization in Handler for Custom URL Scheme                   
- [x] Improper Verification of Source of a Communication Channel                   
- [x] Incorrectly Specified Destination in a Communication Channel                    


### Android application tools.

### Automation in android studion.

- Add in `build.gradle`:

```bash
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'org.owasp:dependency-check-gradle:7.2.1'
    }
}
apply plugin: 'org.owasp.dependencycheck'
```

- Then run.

```bash
./gradlew dependencyCheckAnalyze
```

